# Context-specific headers to protect staging environments
[context.deploy-preview]
  [[context.deploy-preview.headers]]
    for = "/*"
    [context.deploy-preview.headers.values]
      X-Robots-Tag = "noindex, nofollow, noarchive"

[context.branch-deploy]
  [[context.branch-deploy.headers]]
    for = "/*"
    [context.branch-deploy.headers.values]
      X-Robots-Tag = "noindex, nofollow, noarchive"

headers = []

[functions]
[functions."*"]

[build]
  publish = "dist"
  command = "npm run build && node scripts/prerender.cjs && node scripts/generate-sitemap.cjs && node scripts/inject-blog-article-schema.cjs && node scripts/inject-breadcrumb-collection-schema.cjs && node scripts/inject-all-schemas.js"

[build.environment]
  NODE_VERSION = "20"
  PUPPETEER_SKIP_DOWNLOAD = "true"

# Plugins installed/managed in Netlify UI
[[plugins]]
  package = "@netlify/plugin-lighthouse"
  pinned_version = "6"
  origin = "ui"


[[plugins]]
  package = "netlify-plugin-submit-sitemap"
  pinned_version = "0.4"
  origin = "ui"

# Chromium plugin you installed in package.json
[[plugins]]
  package = "netlify-plugin-chromium"
  origin = "config"

# All redirects are now handled in public/_redirects file
# This prevents conflicts and allows proper ordering
